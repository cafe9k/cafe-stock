# 数据洞察 - 我的关注功能说明

## 功能概述

在数据洞察页面的股票查询区域新增了"我的关注"功能，方便用户快速选择和查看已关注的股票信息。

## 功能特点

### 1. 双模式切换

股票查询区域支持两种模式：

-   **搜索股票模式**：通过输入股票代码或名称搜索股票
-   **我的关注模式**：从已关注的股票列表中快速选择

### 2. 我的关注功能

#### 2.1 查看关注列表

-   在"我的关注"标签中显示所有已关注的股票
-   显示关注股票的数量（如：我的关注 (5)）
-   支持下拉搜索过滤已关注的股票

#### 2.2 添加关注

在搜索模式下：

1. 搜索并选择目标股票
2. 点击"添加关注"按钮
3. 该股票将被添加到我的关注列表

#### 2.3 取消关注

可通过两种方式取消关注：

1. **搜索模式**：选择已关注的股票，点击"取消关注"按钮
2. **我的关注模式**：选择股票后，点击"取消关注"按钮

#### 2.4 刷新列表

在我的关注模式下，可点击"刷新列表"按钮更新关注列表

### 3. 股票信息展示

选择股票后自动显示：

-   股票名称和代码
-   所属行业
-   所属市场
-   所在地区
-   关注状态（搜索模式下显示星标按钮）

### 4. 数据同步功能

无论在哪种模式下，选择股票后都可以：

-   查看十大股东信息
-   同步/更新股东数据
-   查看数据同步状态

## 使用场景

### 场景一：快速查看重点关注股票

1. 切换到"我的关注"标签
2. 从下拉列表中选择关注的股票
3. 查看该股票的十大股东信息

### 场景二：添加新的关注股票

1. 在"搜索股票"标签中输入股票代码或名称
2. 从搜索结果中选择目标股票
3. 点击"添加关注"按钮
4. 切换到"我的关注"标签即可看到新添加的股票

### 场景三：管理关注列表

1. 切换到"我的关注"标签
2. 选择需要取消关注的股票
3. 点击"取消关注"按钮
4. 该股票将从关注列表中移除

## 技术实现

### 前端组件

文件：`src/pages/DataInsights.tsx`

新增状态管理：

-   `favoriteStocks`：关注的股票列表
-   `loadingFavorites`：加载关注列表的状态
-   `isFavorite`：当前股票是否已关注
-   `searchMode`：当前模式（search/favorite）

新增功能函数：

-   `loadFavoriteStocks()`：加载关注股票列表
-   `checkIsFavorite()`：检查股票是否已关注
-   `handleToggleFavorite()`：添加/取消关注

### 数据库支持

已有的数据库函数（`electron/db.ts`）：

-   `addFavoriteStock(tsCode)`：添加关注股票
-   `removeFavoriteStock(tsCode)`：删除关注股票
-   `isFavoriteStock(tsCode)`：检查是否已关注
-   `getAllFavoriteStocks()`：获取所有关注的股票代码
-   `countFavoriteStocks()`：统计关注股票数量

### Electron API

已有的 IPC 接口（`electron/main.ts`）：

-   `add-favorite-stock`：添加关注
-   `remove-favorite-stock`：取消关注
-   `is-favorite-stock`：检查关注状态
-   `get-all-favorite-stocks`：获取关注列表
-   `count-favorite-stocks`：统计关注数量

## UI 交互说明

### 按钮状态

1. **添加关注按钮**

    - 类型：primary（主要按钮）
    - 图标：空心星标
    - 文字：添加关注

2. **取消关注按钮**
    - 类型：default（次要按钮）
    - 样式：danger（红色）
    - 图标：实心星标
    - 文字：取消关注

### 标签页

-   搜索股票：显示搜索图标
-   我的关注：显示实心星标图标和关注数量

### 股票信息标签

-   行业：蓝色标签
-   市场：绿色标签
-   地区：默认标签

## 注意事项

1. 关注列表存储在本地数据库中，不会丢失
2. 切换模式时会清空当前选择
3. 取消关注后，需要在"我的关注"模式下刷新列表才能看到最新结果
4. 搜索模式下的搜索结果不包含关注状态，需要选择股票后才能看到是否已关注

## 后续优化建议

1. 添加批量管理功能（批量添加/删除关注）
2. 支持关注股票的分组管理
3. 添加关注股票的排序功能（按添加时间、股票代码等）
4. 支持导入/导出关注列表
5. 添加关注股票的备注功能
6. 在关注列表中直接显示最新数据摘要

