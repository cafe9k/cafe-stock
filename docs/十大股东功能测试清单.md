# 十大股东功能测试清单

## 测试环境准备

-   [ ] 确保 Tushare Pro Token 有效（至少 2000 积分）
-   [ ] 确保网络连接正常
-   [ ] 清空数据库或使用新数据库测试

## 功能测试

### 1. 股票列表同步（首次启动）

-   [ ] 启动应用
-   [ ] 检查终端日志，确认股票列表自动同步
-   [ ] 验证股票数量（约 5000+ 只）

**预期结果**：

-   终端显示 "Synced XXX stocks to database"
-   弹出通知："股票列表同步完成"

### 2. 搜索股票功能

-   [ ] 打开"数据洞察"页面
-   [ ] 在搜索框输入"平安银行"
-   [ ] 检查下拉列表是否显示相关股票
-   [ ] 选择"平安银行 (000001.SZ)"

**预期结果**：

-   搜索响应迅速
-   下拉列表显示匹配的股票
-   显示股票标签：行业、市场、地区

### 3. 查看十大股东（从 API）

-   [ ] 选择一只股票（如：平安银行 000001.SZ）
-   [ ] 等待数据加载
-   [ ] 检查表格是否显示十大股东数据

**预期结果**：

-   显示加载状态
-   表格显示十大股东列表
-   数据包含：股东名称、持股数量、持股比例、报告期、公告日期

### 4. 查看同步统计

-   [ ] 查看页面顶部统计卡片
-   [ ] 检查显示的数据：
    -   股票总数
    -   已同步数量
    -   同步进度

**预期结果**：

-   显示准确的统计数据
-   初始状态：已同步 = 0

### 5. 单股同步测试

-   [ ] 选择一只未同步的股票
-   [ ] 点击"同步数据"按钮
-   [ ] 等待同步完成
-   [ ] 检查页面显示"已同步"标签
-   [ ] 再次点击按钮，验证按钮文字变为"更新数据"

**预期结果**：

-   同步成功提示
-   数据立即显示在表格中
-   统计数据更新（已同步 +1）
-   按钮文字改变

### 6. 批量同步测试（小范围）

**注意**：完整同步需要 1-2 小时，建议测试时只同步少量股票。

-   [ ] 点击"同步所有股票十大股东"按钮
-   [ ] 阅读确认对话框
-   [ ] 点击"开始同步"
-   [ ] 观察进度弹窗：
    -   进度条
    -   成功/跳过/失败统计
    -   当前同步的股票信息

**预期结果**：

-   弹出确认对话框
-   显示同步进度弹窗
-   实时更新进度
-   已同步的股票显示"跳过"状态
-   同步过程中可关闭弹窗

### 7. 数据优先级测试

-   [ ] 选择一只已同步的股票
-   [ ] 观察数据加载速度
-   [ ] 检查终端日志

**预期结果**：

-   数据立即显示（从数据库加载）
-   终端显示 "get-top10-holders-from-db"
-   不调用 Tushare API

### 8. 更新数据测试

-   [ ] 选择一只已同步的股票
-   [ ] 点击"更新数据"按钮
-   [ ] 等待更新完成
-   [ ] 对比更新前后的数据

**预期结果**：

-   删除旧数据
-   拉取最新数据
-   显示更新成功提示

### 9. 限流保护测试

-   [ ] 开始批量同步
-   [ ] 观察终端日志的请求间隔
-   [ ] 检查是否有限流错误

**预期结果**：

-   每次请求间隔至少 200ms
-   如遇限流，自动等待 5 秒
-   不会因为限流而中断同步

### 10. 数据去重测试

-   [ ] 选择一只已同步的股票
-   [ ] 多次点击"更新数据"
-   [ ] 检查数据库中的记录数

**预期结果**：

-   不会产生重复数据
-   每次更新覆盖旧数据

## 边界测试

### 11. 空数据测试

-   [ ] 选择一只没有十大股东数据的股票
-   [ ] 观察页面提示

**预期结果**：

-   显示"暂无十大股东数据"提示
-   不报错

### 12. 网络异常测试

-   [ ] 断开网络连接
-   [ ] 尝试同步数据
-   [ ] 观察错误提示

**预期结果**：

-   显示友好的错误提示
-   不崩溃

### 13. 同步中断测试

-   [ ] 开始批量同步
-   [ ] 关闭进度弹窗
-   [ ] 观察后台是否继续同步

**预期结果**：

-   后台继续同步
-   可重新打开查看进度

### 14. 搜索边界测试

-   [ ] 搜索不存在的股票（如："不存在的股票"）
-   [ ] 搜索特殊字符（如："@#$%"）
-   [ ] 搜索空字符串

**预期结果**：

-   不存在的股票：无结果
-   特殊字符：无结果或报错提示
-   空字符串：清空列表

## 性能测试

### 15. 数据库查询性能

-   [ ] 同步至少 100 只股票的数据
-   [ ] 随机查询多只股票
-   [ ] 测量加载时间

**预期结果**：

-   查询响应时间 < 100ms
-   界面流畅，无卡顿

### 16. 批量同步性能

-   [ ] 记录同步开始时间
-   [ ] 同步 100 只股票
-   [ ] 记录完成时间

**预期结果**：

-   平均每只股票 < 1 秒
-   总耗时合理

## UI/UX 测试

### 17. 界面响应

-   [ ] 点击各个按钮观察响应
-   [ ] 检查 loading 状态
-   [ ] 检查按钮禁用状态

**预期结果**：

-   按钮点击有即时反馈
-   loading 状态准确
-   同步中按钮正确禁用

### 18. 数据展示

-   [ ] 检查表格排版
-   [ ] 检查数字格式化
-   [ ] 检查日期格式化

**预期结果**：

-   表格整齐美观
-   数字有千分位分隔
-   日期格式正确（YYYY-MM-DD）

### 19. 进度展示

-   [ ] 观察进度条动画
-   [ ] 检查统计数据更新
-   [ ] 检查当前股票信息显示

**预期结果**：

-   进度条平滑更新
-   统计数据实时更新
-   股票信息清晰显示

## 数据一致性测试

### 20. 数据库一致性

-   [ ] 同步数据后检查数据库
-   [ ] 验证唯一约束
-   [ ] 验证索引

**预期结果**：

-   无重复数据
-   唯一约束生效
-   索引正常

### 21. 统计数据一致性

-   [ ] 同步数据后
-   [ ] 对比统计数据与实际数据库记录
-   [ ] 验证数量一致

**预期结果**：

-   统计数据与实际一致
-   同步进度准确

## 测试总结

### 测试结果

-   通过：**\_** / 21
-   失败：**\_** / 21
-   阻塞：**\_** / 21

### 发现的问题

| 编号 | 问题描述 | 严重程度 | 状态 |
| ---- | -------- | -------- | ---- |
|      |          |          |      |

### 测试结论

-   [ ] 功能完整，可以发布
-   [ ] 存在小问题，需要修复
-   [ ] 存在严重问题，不能发布

### 备注

（在此记录测试过程中的其他发现和建议）
